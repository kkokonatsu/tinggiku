<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pengukur Tinggi Badan via Foto</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: 'Poppins', 'Inter', sans-serif;
        scroll-behavior: smooth;
      }
      .file-input-container {
        position: relative;
        overflow: hidden;
        display: inline-block;
      }
      .file-input-container input[type='file'] {
        position: absolute;
        font-size: 100px; /* Make it large enough to cover the button */
        left: 0;
        top: 0;
        opacity: 0;
        cursor: pointer;
      }
      .file-input-label {
        cursor: pointer;
      }
      /* Custom scrollbar (optional, for aesthetics) */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #f0f4f8; /* Slightly off-white for track */
      }
      ::-webkit-scrollbar-thumb {
        background: #a7c7e7; /* primary color */
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #8fabca; /* Darker primary on hover */
      }
    </style>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: '#D3ECF4',
              'primary-dark': '#83B3D6', // Biru sedikit lebih tua untuk hover
              secondary: '#6480CA', // Krem hangat
              accent: '#B2D8B2', // Hijau mint lembut
              'accent-dark': '#9CCB9C', // Hijau mint sedikit lebih tua
              'text-dark': '#263B76', // Abu-abu tua (hampir hitam)
              'text-light': '#7f8c8d', // Abu-abu medium
              background: '#f0f4f8', // Latar belakang sangat terang (off-white biru)
              'card-bg': '#ffffff', // Putih untuk card
              'border-color': '#d1d9e6', // Warna border lembut
            },
            fontFamily: {
              sans: ['Poppins', 'Inter', 'sans-serif'],
            },
          },
        },
      };
    </script>
  </head>
  <body class="bg-background text-text-dark antialiased">
    <header class="bg-primary shadow-md sticky top-0 z-50">
      <div
        class="container mx-auto px-4 sm:px-6 py-4 flex justify-between items-center"
      >
        <a href="#" class="flex items-center space-x-2">
          <img
            src="../static/img/logo.png"
            alt="Logo Ukur Tinggi Badan"
            class="h-10 sm:h-10"
          />
        </a>
        <nav class="hidden md:flex space-x-12">
          <a
            href="#measurementForm"
            class="text-dark font-semibold hover:text-secondary transition duration-150"
            >Unggah Foto</a
          >
          <a
            href="#panduan-foto"
            class="text-dark font-semibold hover:text-secondary transition duration-150"
            >Panduan</a
          >
        </nav>
        <button id="mobileMenuButton" class="md:hidden text-black text-2xl">
          <i class="fas fa-bars"></i>
        </button>
      </div>
      <div id="mobileMenu" class="md:hidden hidden bg-primary-dark">
        <a
          href="#measurementForm"
          class="block text-white text-center py-3 hover:bg-primary transition duration-150"
          >Unggah Foto</a
        >
        <hr />
        <a
          href="#panduan-foto"
          class="block text-white text-center py-3 hover:bg-primary transition duration-150"
          >Panduan</a
        >
      </div>
    </header>

    <main class="container mx-auto px-4 sm:px-44 py-8 sm:py-12">
      <div class="text-center mb-8 sm:mb-12">
        <h1 class="text-3xl sm:text-4xl font-bold text-text-dark mb-3 sm:mb-2">
          TinggiKu
        </h1>
        <h2 class="text-xl sm:text-2xl font-bold text-text-dark mb-3 sm:mb-4">
          Pengukur Tinggi Badan Otomatis
        </h2>
        <p class="text-text-light text-base sm:text-lg max-w-2xl mx-auto">
          Bersama AI kami bantu Anda menghitung tinggi badan dengan akurat dalam
          waktu singkat tanpa alat ukur
        </p>
      </div>

      <form
        id="measurementForm"
        action="/ukur_tinggi"
        method="POST"
        enctype="multipart/form-data"
      >
        <div class="grid grid-cols-1 gap-6 sm:gap-8">
          <div
            class="bg-card-bg p-6 sm:p-8 rounded-xl shadow-lg border border-border-color"
          >
            <h3
              class="text-2xl sm:text-2xl font-bold text-text-dark mb-6 text-center"
            >
              Unggah Foto Anda
            </h3>

            <div class="grid md:grid-cols-2 gap-6">
              <div
                class="shadow-inner rounded-xl border-2 border-indigo-100 p-6 md:col-span-1"
              >
                <div class="mb-6 text-center drop-shadow-sm">
                  <img
                    id="imagePreview"
                    src="data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22400%22%20height%3D%22300%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20400%20300%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%23holder_17972d70259%20text%20%7B%20fill%3A%23999%3Bfont-weight%3Anormal%3Bfont-family%3AHelvetica%2C%20monospace%3Bfont-size%3A20pt%20%7D%20%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22holder_17972d70259%22%3E%3Crect%20width%3D%22400%22%20height%3D%22300%22%20fill%3D%22%23eee%22%3E%3C%2Frect%3E%3Cg%3E%3Ctext%20x%3D%22133.453125%22%20y%3D%22159.3%22%3EPratinjau Gambar%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E"
                    alt="Pratinjau Gambar"
                    class="w-full h-auto object-contain rounded-lg border-2 border-dashed border-border-color bg-background mb-4"
                    style="min-height: 150px; max-height: 350px"
                  />
                </div>

                <div
                  class="file-input-container w-full bg-primary-dark hover:bg-secondary text-white font-medium py-3 px-4 rounded-lg text-center transition duration-300 ease-in-out transform hover:scale-105"
                >
                  <label
                    for="fileUpload"
                    class="file-input-label flex items-center justify-center space-x-2 text-base sm:text-lg"
                  >
                    <i class="fas fa-cloud-upload-alt"></i>
                    <span>Pilih Foto dari Perangkat</span>
                  </label>
                  <input
                    type="file"
                    id="fileUpload"
                    name="foto_pengguna"
                    accept="image/png, image/jpeg, image/webp"
                    class="cursor-pointer"
                  />
                </div>
                <p class="text-xs text-text-light mt-3 text-center">
                  Format: JPG, PNG, HEIC, WEBP. Maks: 5MB.
                </p>
              </div>

              <div class="md:col-span-1 flex flex-col">
                <div
                  class="bg-background p-6 rounded-lg shadow-inner border border-border-color min-h-[180px] flex flex-col justify-center items-center mb-6 flex-grow"
                >
                  <h4 class="text-lg font-semibold text-text-dark mb-4">
                    Hasil Estimasi
                  </h4>
                  <div
                    id="resultArea"
                    class="text-center flex flex-col justify-center items-center w-full"
                  >
                    <div
                      id="loadingIndicator"
                      class="hidden mb-4 flex flex-col justify-center items-center"
                    >
                      <div
                        class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"
                      ></div>
                      <p class="text-text-light mt-3">Sedang memproses...</p>
                    </div>
                    <div id="measurementResult" class="hidden">
                      <p class="text-text-light text-base sm:text-lg mb-1">
                        Estimasi Tinggi Badan Anda
                      </p>
                      <p
                        class="text-4xl sm:text-5xl font-bold text-secondary mb-2"
                      >
                        <span id="heightValue">-</span> cm
                      </p>
                      <p class="text-xs text-text-light">
                        (Hasil ini adalah estimasi berdasarkan foto)
                      </p>
                    </div>
                    <div id="errorResult" class="hidden">
                      <i
                        class="fas fa-exclamation-triangle text-4xl text-red-500 mb-3"
                      ></i>
                      <p class="text-text-light"
                        >Gagal memproses gambar. Coba lagi.</p
                      >
                    </div>
                    <div id="noResult" class="">
                      <i
                        class="fas fa-chart-line text-5xl sm:text-6xl text-border-color mb-4"
                      ></i>
                      <p class="text-text-light text-sm sm:text-base">
                        Hasil pengukuran akan muncul di sini.
                      </p>
                    </div>
                  </div>
                </div>

                <div
                  class="bg-yellow-100 p-4 rounded-lg shadow-inner border border-yellow-300 text-yellow-800 text-sm sm:text-base"
                >
                  <p class="flex items-center gap-2">
                    <i class="fas fa-info-circle mr-2"></i>Pastikan gambar yang
                    diunggah sesuai dengan panduan di bawah untuk memaksimalkan
                    hasil pengukuran kami
                  </p>
                </div>
              </div>
            </div>

            <button
              type="button"
              id="measureButton"
              class="w-full mt-8 bg-accent hover:bg-accent-dark text-white font-bold py-3 px-6 rounded-lg transition duration-300 ease-in-out transform hover:scale-105 flex items-center justify-center space-x-2 text-base sm:text-lg"
              disabled
            >
              <i class="fas fa-ruler-vertical"></i>
              <span>Ukur Tinggi Saya</span>
            </button>
          </div>

          <div
            id="panduan-foto"
            class="bg-card-bg p-6 sm:p-8 rounded-xl shadow-lg border border-border-color"
          >
            <h3
              class="text-2xl sm:text-2xl font-bold text-text-dark mb-6 text-center"
            >
              Panduan Foto
            </h3>
            <div class="grid md:grid-cols-2 gap-6">
              <div class="md:col-span-1 flex flex-col justify-between">
                <div
                  class="p-4 bg-background rounded-lg shadow-sm border border-border-color flex-grow"
                >
                  <h4
                    class="text-lg font-semibold text-text-dark mb-2 flex items-center"
                  >
                    <i class="fas fa-person text-secondary mr-2"></i>Postur
                    Tubuh
                  </h4>
                  <p class="text-text-light text-sm">
                    Berdiri tegak dengan postur yang baik, seluruh tubuh dari
                    kepala hingga kaki terlihat, dan hindari penutup kepala dan
                    sepatu hak tinggi
                  </p>
                </div>
                <div
                  class="p-4 bg-background rounded-lg shadow-sm border border-border-color flex-grow mt-6"
                >
                  <h4
                    class="text-lg font-semibold text-text-dark mb-2 flex items-center"
                  >
                    <i class="fas fa-lightbulb text-secondary mr-2"></i>Kualitas
                    Foto
                  </h4>
                  <p class="text-text-light text-sm">
                    Gunakan pencahayaan yang baik dan pastikan foto tidak buram
                    ataupun kabur
                  </p>
                </div>
                <div
                  class="p-4 bg-background rounded-lg shadow-sm border border-border-color flex-grow mt-6"
                >
                  <h4
                    class="text-lg font-semibold text-text-dark mb-2 flex items-center"
                  >
                    <i class="fas fa-camera text-secondary mr-2"></i>Jarak &
                    Sudut Kamera
                  </h4>
                  <p class="text-text-light text-sm">
                    Ambil foto dari jarak yang cukup agar seluruh tubuh terlihat
                    dan hindari sudut pengambilan dari atas atau bawah
                  </p>
                </div>
              </div>
              <div class="md:col-span-1 flex items-center justify-center">
                <img
                  src="../static/img/example.png"
                  alt="Contoh Foto Akurat"
                  class="w-full h-auto object-contain rounded-lg border-2 border-dashed border-border-color bg-background"
                  style="height: 450px"
                />
              </div>
            </div>
          </div>
        </div>
      </form>
    </main>

    <footer class="bg-text-dark text-background mt-12 sm:mt-16">
      <div class="container mx-auto px-4 sm:px-6 py-8 text-center">
        <p class="text-sm"
          >&copy; <span id="currentYear"></span> <b>TinggiKu</b></p
        >
        <p>Privasi Anda kami lindungi</p>
        <p class="text-xs text-gray-400 mt-1"
          >Dibuat dengan <i class="fas fa-heart text-primary"></i> untuk
          kemudahan Anda.</p
        >
      </div>
    </footer>

    <script>
      const fileUpload = document.getElementById('fileUpload');
      const imagePreview = document.getElementById('imagePreview');
      const measureButton = document.getElementById('measureButton');
      const objectHeightInput = document.getElementById('objectHeight');
      const measurementForm = document.getElementById('measurementForm');

      const loadingIndicator = document.getElementById('loadingIndicator');
      const measurementResult = document.getElementById('measurementResult');
      const heightValue = document.getElementById('heightValue');
      const noResult = document.getElementById('noResult');
      const errorResult = document.getElementById('errorResult');

      const mobileMenuButton = document.getElementById('mobileMenuButton');
      const mobileMenu = document.getElementById('mobileMenu');

      document.getElementById('currentYear').textContent =
        new Date().getFullYear();

      mobileMenuButton.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
      });
      // Close mobile menu if a link is clicked
      mobileMenu.querySelectorAll('a').forEach((link) => {
        link.addEventListener('click', () => {
          mobileMenu.classList.add('hidden');
        });
      });

      fileUpload.addEventListener('change', function (event) {
        const file = event.target.files[0];
        if (file) {
          // Validasi tipe file (opsional tambahan di client-side)
          const validImageTypes = ['image/jpeg', 'image/png', 'image/webp'];
          if (!validImageTypes.includes(file.type)) {
            alert('Format file tidak valid. Harap unggah JPG, PNG, atau WEBP.');
            fileUpload.value = ''; // Reset input file
            imagePreview.src =
              'data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22400%22%20height%3D%22300%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20400%20300%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%23holder_17972d70259%20text%20%7B%20fill%3A%23999%3Bfont-weight%3Anormal%3Bfont-family%3AHelvetica%2C%20monospace%3Bfont-size%3A20pt%20%7D%20%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22holder_17972d70259%22%3E%3Crect%20width%3D%22400%22%20height%3D%22300%22%20fill%3D%22%23eee%22%3E%3C%2Frect%3E%3Cg%3E%3Ctext%20x%3D%22200%22%20y%3D%22150%22%20text-anchor%3D%22middle%22%20dominant-baseline%3D%22middle%22%3EPratinjau%20Gambar%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E';
            measureButton.disabled = true;
            return;
          }
          // Validasi ukuran file (misal 5MB)
          if (file.size > 5 * 1024 * 1024) {
            alert('Ukuran file terlalu besar. Maksimal 5MB.');
            fileUpload.value = '';
            imagePreview.src =
              'data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22400%22%20height%3D%22300%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20400%20300%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%23holder_17972d70259%20text%20%7B%20fill%3A%23999%3Bfont-weight%3Anormal%3Bfont-family%3AHelvetica%2C%20monospace%3Bfont-size%3A20pt%20%7D%20%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22holder_17972d70259%22%3E%3Crect%20width%3D%22400%22%20height%3D%22300%22%20fill%3D%22%23eee%22%3E%3C%2Frect%3E%3Cg%3E%3Ctext%20x%3D%22200%22%20y%3D%22150%22%20text-anchor%3D%22middle%22%20dominant-baseline%3D%22middle%22%3EPratinjau%20Gambar%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E';
            measureButton.disabled = true;
            return;
          }

          const reader = new FileReader();
          reader.onload = function (e) {
            imagePreview.src = e.target.result;
          };
          reader.readAsDataURL(file);
          measureButton.disabled = false;
          noResult.classList.add('hidden');
          measurementResult.classList.add('hidden');
          errorResult.classList.add('hidden');
        } else {
          imagePreview.src =
            'data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22400%22%20height%3D%22300%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20400%20300%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%23holder_17972d70259%20text%20%7B%20fill%3A%23999%3Bfont-weight%3Anormal%3Bfont-family%3AHelvetica%2C%20monospace%3Bfont-size%3A20pt%20%7D%20%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22holder_17972d70259%22%3E%3Crect%20width%3D%22400%22%20height%3D%22300%22%20fill%3D%22%23eee%22%3E%3C%2Frect%3E%3Cg%3E%3Ctext%20x%3D%22200%22%20y%3D%22150%22%20text-anchor%3D%22middle%22%20dominant-baseline%3D%22middle%22%3EPratinjau%20Gambar%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E';
          measureButton.disabled = true;
          noResult.classList.remove('hidden');
        }
      });

      measureButton.addEventListener('click', async function () {
        if (!fileUpload.files || fileUpload.files.length === 0) {
          alert('Harap pilih foto terlebih dahulu.');
          return;
        }

        // Sembunyikan hasil sebelumnya dan tampilkan loading
        measurementResult.classList.add('hidden');
        noResult.classList.add('hidden');
        errorResult.classList.add('hidden');
        loadingIndicator.classList.remove('hidden');
        measureButton.disabled = true;
        const originalButtonText = measureButton.innerHTML;
        measureButton.innerHTML =
          '<div class="animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white mr-2"></div> Mengukur...';

        // --- DUMMY FLASK ROUTE INTERACTION (SIMULASI) ---
        // Di aplikasi nyata, Anda akan menggunakan FormData dan fetch API
        // const formData = new FormData(measurementForm);
        // try {
        //    const response = await fetch('/ukur_tinggi', {
        //        method: 'POST',
        //        body: formData,
        //    });
        //    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        //    const data = await response.json(); // Misal backend mengembalikan JSON: { "tinggi": 175.5 }
        //
        //    heightValue.textContent = data.tinggi;
        //    measurementResult.classList.remove('hidden');
        // } catch (e) {
        //    console.error("Error saat pengukuran:", e);
        //    errorResult.classList.remove('hidden');
        // } finally {
        //    loadingIndicator.classList.add('hidden');
        //    measureButton.disabled = false;
        //    measureButton.innerHTML = originalButtonText;
        // }

        // Untuk sekarang, kita gunakan simulasi timeout seperti sebelumnya
        setTimeout(() => {
          const randomHeight = (150 + Math.random() * 50).toFixed(1); // Tinggi acak
          heightValue.textContent = randomHeight;

          loadingIndicator.classList.add('hidden');
          measurementResult.classList.remove('hidden');
          measureButton.disabled = false;
          measureButton.innerHTML = originalButtonText; // Kembalikan teks tombol semula
        }, 2500); // Simulasi waktu proses
      });
    </script>
  </body>
</html>
